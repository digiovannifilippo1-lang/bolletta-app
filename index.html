<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Preventivo Energia PRO</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg:#0a0a14; --surface:#13132a; --surface2:#1a1a35;
      --text:#f1f5f9; --text2:#94a3b8;
      --border:rgba(120,80,255,0.2);
      --wt:#e07020; --opt:#0ea5e9;
      --success:#22c55e; --error:#ef4444;
    }
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--text);padding:20px;min-height:100vh;}
    .container{max-width:960px;margin:0 auto;}

    /* HEADER */
    .header{text-align:center;padding:28px 20px 22px;background:var(--surface);border-radius:16px;border:1px solid var(--border);margin-bottom:26px;}
    .logo{font-size:2rem;font-weight:900;background:linear-gradient(135deg,#7c3aed,#06b6d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
    .header p{color:var(--text2);margin-top:6px;font-size:0.92rem;}

    /* TABS */
    .tabs{display:flex;gap:0;margin-bottom:26px;background:var(--surface);border-radius:12px;padding:4px;border:1px solid var(--border);}
    .tab-btn{flex:1;padding:12px;background:none;border:none;color:var(--text2);cursor:pointer;font-size:1rem;font-weight:600;border-radius:10px;transition:all 0.25s;}
    .tab-btn.active{background:linear-gradient(135deg,#7c3aed,#4f46e5);color:#fff;}

    /* CARD */
    .card{background:var(--surface);border-radius:14px;padding:22px;border:1px solid var(--border);margin-bottom:18px;}
    .card-title{font-size:1rem;font-weight:700;color:#a78bfa;margin-bottom:14px;display:flex;align-items:center;gap:8px;}

    /* UPLOAD */
    .upload-area{border:2px dashed rgba(120,80,255,0.35);border-radius:12px;padding:38px 20px;text-align:center;cursor:pointer;transition:all 0.3s;background:rgba(120,80,255,0.04);}
    .upload-area:hover{border-color:#7c3aed;background:rgba(120,80,255,0.1);}
    .upload-area.dragover{border-color:var(--success);background:rgba(34,197,94,0.07);}
    .upload-area h3{color:var(--text);margin-bottom:6px;font-size:1rem;}
    .upload-area p{color:var(--text2);font-size:0.83rem;}
    .upload-icon{font-size:2.4rem;margin-bottom:8px;}
    .file-input{display:none;}
    .status-bar{display:none;flex-direction:row;align-items:center;gap:12px;margin-top:13px;background:rgba(120,80,255,0.1);border-radius:8px;padding:10px 14px;font-size:0.88rem;}
    .spinner{width:16px;height:16px;border:3px solid rgba(120,80,255,0.3);border-top:3px solid #7c3aed;border-radius:50%;animation:spin 1s linear infinite;flex-shrink:0;}
    @keyframes spin{to{transform:rotate(360deg);}}

    /* OPERATORE SELECTOR */
    .op-selector{display:none;margin-bottom:18px;}
    .op-selector-title{color:var(--text2);font-size:0.88rem;margin-bottom:11px;text-align:center;}
    .op-buttons{display:flex;gap:12px;}
    .op-btn{flex:1;padding:14px 10px;border-radius:12px;border:2px solid transparent;cursor:pointer;font-size:0.9rem;font-weight:700;transition:all 0.25s;background:var(--surface2);color:var(--text2);text-align:center;}
    .op-btn:hover{transform:translateY(-2px);}
    .op-btn img{height:32px;object-fit:contain;display:block;margin:0 auto 8px;}
    .op-btn.wt{border-color:rgba(224,112,32,0.3);}
    .op-btn.wt.selected,.op-btn.wt:hover{background:rgba(224,112,32,0.15);border-color:var(--wt);color:#fdba74;}
    .op-btn.opt{border-color:rgba(14,165,233,0.3);}
    .op-btn.opt.selected,.op-btn.opt:hover{background:rgba(14,165,233,0.15);border-color:var(--opt);color:#7dd3fc;}
    .op-sub{font-size:0.7rem;color:var(--text2);font-weight:400;margin-top:3px;display:block;line-height:1.4;}

    /* WINDTRE CLIENTE TOGGLE */
    .wt-toggle-box{display:none;background:rgba(224,112,32,0.08);border:1px solid rgba(224,112,32,0.3);border-radius:12px;padding:16px 18px;margin-bottom:16px;}
    .wt-toggle-label{font-size:0.92rem;font-weight:600;color:#fdba74;margin-bottom:12px;display:flex;align-items:center;gap:8px;}
    .wt-toggle-btns{display:flex;gap:10px;}
    .wt-sub-btn{flex:1;padding:11px 8px;border-radius:10px;border:2px solid transparent;cursor:pointer;font-size:0.88rem;font-weight:700;transition:all 0.2s;background:var(--surface2);color:var(--text2);text-align:center;}
    .wt-sub-btn:hover{transform:translateY(-1px);}
    .wt-sub-btn.yes{border-color:rgba(224,112,32,0.3);}
    .wt-sub-btn.yes.selected,.wt-sub-btn.yes:hover{background:rgba(224,112,32,0.2);border-color:var(--wt);color:#fdba74;}
    .wt-sub-btn.no{border-color:rgba(148,163,184,0.3);}
    .wt-sub-btn.no.selected,.wt-sub-btn.no:hover{background:rgba(148,163,184,0.1);border-color:#94a3b8;color:var(--text);}
    .wt-sub-detail{font-size:0.72rem;color:var(--text2);margin-top:3px;display:block;}

    /* MESSAGGI */
    .msg{border-radius:8px;padding:11px 14px;margin-bottom:16px;display:none;font-weight:500;font-size:0.9rem;}
    .msg.error{background:rgba(239,68,68,0.12);border:2px solid var(--error);color:var(--error);}
    .msg.success{background:rgba(34,197,94,0.12);border:2px solid var(--success);color:var(--success);}

    /* RISULTATI */
    .results{display:none;}

    /* Hero */
    .hero{border-radius:14px;padding:26px 20px;text-align:center;margin-bottom:16px;border:2px solid;}
    .hero.saving{background:linear-gradient(135deg,rgba(34,197,94,0.12),rgba(34,197,94,0.04));border-color:rgba(34,197,94,0.35);}
    .hero.losing{background:linear-gradient(135deg,rgba(239,68,68,0.12),rgba(239,68,68,0.04));border-color:rgba(239,68,68,0.3);}
    .hero-periodo{font-size:0.75rem;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:4px;}
    .hero-amount{font-size:2.8rem;font-weight:900;line-height:1;}
    .hero-amount.green{color:var(--success);}
    .hero-amount.red{color:var(--error);}
    .hero-label{font-size:0.82rem;color:var(--text2);margin-top:5px;}
    .perc-pill{display:inline-block;padding:5px 15px;border-radius:20px;font-weight:800;font-size:0.95rem;margin-top:9px;}
    .perc-pill.green{background:rgba(34,197,94,0.16);color:var(--success);border:1.5px solid rgba(34,197,94,0.28);}
    .perc-pill.red{background:rgba(239,68,68,0.14);color:var(--error);border:1.5px solid rgba(239,68,68,0.28);}
    .hero-annuale{margin-top:12px;padding-top:12px;border-top:1px solid rgba(255,255,255,0.07);font-size:0.82rem;color:var(--text2);}
    .hero-annuale span{font-weight:700;}
    .hero-annuale span.green{color:var(--success);}
    .hero-annuale span.red{color:var(--error);}

    /* Grid numeri */
    
